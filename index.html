<!DOCTYPE html>
<html>
<head>
  <title>React! React! React!</title>
  <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>

</head>
<body >

<style type="text/css">
  


.square {
  background:   gray;
  border: 1px solid #999;
  float: left;
  font-size: 24px;
  height: 55px;
  margin-right: -1px;
  margin-top: -1px;
  padding: 0;
  text-align: center;
  width: 55px;
}

.square:focus {
  outline: none;
}


.kbd-navigation .square:focus {
  background: #ddd;
}

.game {
  display: flex;
  flex-direction: row;
  justify-content: center;
 align-items: center;
}

.game-info {
  margin-left: 20px;
}
.tod{
	display: flex;
	justify-content: center;
	align-items: center;
	flex-direction: column;
	
}
</style>
<div class="tod">

<div id="root"></div>
<h2>BUSCAMINAS</h2>
<h3>10 minas</h3>
<button className="reiniciar" onclick="location.reload()"> REINICIAR</button>
</div>

<script type="text/babel">
var ini=0;
function Square(props) {
  return (
    <button className="square" onClick={props.onClick}>
      {props.value} 
    </button>
  );
}


function Bomba(props) {
  return (
    <button className="inicio" onClick={props.onClick}>
      INICIAR
    </button>
	
  );
}


class Board extends React.Component {
	constructor(props) {
		super(props);
		this.state = {
	squares: Array(80).fill(null), 
	bombas: Array(9).fill(null)
   };
}

handleClick(i){   
	var x,y,j;
	if(ini==0){return;}
	const squares = this.state.squares.slice();
		squares[i] = ContadorBombas(this.state.bombas,i);
	if(squares[i]==-1){
		x =this.state.bombas;
		for(j=0;j<10;j++){
			y=x[j];
			squares[y]=-1;//minas
			this.setState({squares: squares});
		}
		alert("Perdiste");
	}else{
		
		this.setState({squares: squares});  
			
		
	}
	return;
}
  
bombas(){
	var i,j,k;
	var myArray = [];
	const bombas = this.state.bombas.slice();
	

	for(i=0;i<80;i++){
		myArray[i]=i;
	}
	console.log(myArray);	
	for (i = 0; i<10; i++) {
		j = Math.floor(Math.random() * 81);
		k = myArray[i - 1];//crea numeros aleatorios que no se repitan
		myArray[i - 1] = myArray[j];
		myArray[j] = k;
	}

	for( i=0;i < 10;i++){
		bombas[i]=myArray[i];
	}
	ini=1;
	console.log(bombas);
    this.setState({bombas: bombas});
    alert("Listo");
}

renderSquare(i) {
  return (
      < Square value={this.state.squares[i]}        onClick={() => this.handleClick(i)}/>
    );
  }

  renderBomba(i) {
  return (
      < Bomba onClick={() => this.bombas()}/>
    );
  }


render() {
    return (
      <div>
        {this.renderBomba()}
		
        <div className="board-row">
          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}

        </div>
        <div className="board-row">
          {this.renderSquare(9)}
          {this.renderSquare(10)}
          {this.renderSquare(11)}
          {this.renderSquare(12)}
          {this.renderSquare(13)}
          {this.renderSquare(14)}
          {this.renderSquare(15)}
          {this.renderSquare(16)}
          {this.renderSquare(17)}
        </div>
        <div className="board-row">
          {this.renderSquare(18)}
          {this.renderSquare(19)}
          {this.renderSquare(20)}
          {this.renderSquare(21)}
          {this.renderSquare(22)}
          {this.renderSquare(23)}
          {this.renderSquare(24)}
          {this.renderSquare(25)}
          {this.renderSquare(26)}
        </div>
  <div className="board-row">
          {this.renderSquare(27)}
          {this.renderSquare(28)}
          {this.renderSquare(29)}
          {this.renderSquare(30)}
          {this.renderSquare(31)}
          {this.renderSquare(32)}
          {this.renderSquare(33)}
          {this.renderSquare(34)}
          {this.renderSquare(35)}
        </div>

  <div className="board-row">
          {this.renderSquare(36)}
          {this.renderSquare(37)}
          {this.renderSquare(38)}
          {this.renderSquare(39)}
          {this.renderSquare(40)}
          {this.renderSquare(41)}
          {this.renderSquare(42)}
          {this.renderSquare(43)}
          {this.renderSquare(44)}
        </div>

  <div className="board-row">
          {this.renderSquare(45)}
          {this.renderSquare(46)}
          {this.renderSquare(47)}
          {this.renderSquare(48)}
          {this.renderSquare(49)}
          {this.renderSquare(50)}
          {this.renderSquare(51)}
          {this.renderSquare(52)}
          {this.renderSquare(53)}
        </div>
  <div className="board-row">
          {this.renderSquare(54)}
          {this.renderSquare(55)}
          {this.renderSquare(56)}
          {this.renderSquare(57)}
          {this.renderSquare(58)}
          {this.renderSquare(59)}
          {this.renderSquare(60)}
          {this.renderSquare(61)}
          {this.renderSquare(62)}
        </div>

  <div className="board-row">
          {this.renderSquare(63)}
          {this.renderSquare(64)}
          {this.renderSquare(65)}
          {this.renderSquare(66)}
          {this.renderSquare(67)}
          {this.renderSquare(68)}
          {this.renderSquare(69)}
          {this.renderSquare(70)}
          {this.renderSquare(71)}
        </div>

  <div className="board-row">
          {this.renderSquare(72)}
          {this.renderSquare(73)}
          {this.renderSquare(74)}
          {this.renderSquare(75)}
          {this.renderSquare(76)}
          {this.renderSquare(77)}
          {this.renderSquare(78)}
          {this.renderSquare(79)}
          {this.renderSquare(80)}
        </div>


      </div>
    );
  }
}


class Game extends React.Component {
  render() {
    return (

      <div className="game" >
        <div className="game-board">
          <Board />
        </div>
        <div className="game-info">
          
          
        </div>
      </div>
    );
  }
}

// ========================================

ReactDOM.render(
 <Game />,
 document.getElementById("root")
);



function ContadorBombas(bombas,i) {
	var conta=0,band=0,a,b,c,d,e,f,g,h,i,k;

	console.log("bombas:"+bombas);
	if(i==0)
	{
		a=-1;
		b=-1;
		c=-1;
		d=-1;
		e=i;
		f=i+1;
		g=-1;
		h=i+9;
		i=i+10;
	}else if(i==8)
	{
		a=-1;
		b=-1;
		c=-1;
		d=i-1;
		e=i;
		f=-1;
		g=i+8;
		h=i+9;
		i=-1;
	}else if(i==72)
	{
		a=-1;
		b=i-9;
		c=i-8;
		d=-1;
		e=i;
		f=i+1;
		g=-1;
		h=-1;
		i=-1;
	}else if(i==80)
	{
		a=i-10;
		b=i-9;
		c=-1;
		d=i-1;
		e=i;
		f=-1;
		g=-1;
		h=-1;
		i=-1;
	}else if(i<8)
	{
		a=-1;
		b=-1;
		c=-1;
		d=i-1;
		e=i;
		f=i+1;
		g=i+8;
		h=i+9;
		i=i+10;
	}else if(i>72 && i<80)
	{
		a=i-10;
		b=i-9;
		c=i-8;
		d=i-1;
		e=i;
		f=i+1;
		g=-1;
		h=-1;
		i=-1;
		
	}else if(i== 17 || i== 26 || i== 35 || i== 44 || i== 53 || i== 62 || i== 71)
	{
		a=i-10;
		b=i-9;
		c=-1;
		d=i-1;
		e=i;
		f=-1;
		g=i+8;
		h=i+9;
		i=-1;
	}else if(i== 18 || i== 27 || i== 36 || i== 45 || i== 54 || i== 63 || i== 72)
	{
		a=-1;
		b=i-9;
		c=i-8;
		d=-1;
		e=i;
		f=i+1;
		g=-1;
		h=i+9;
		i=i+10;
	}
	else
	
	{
		a=i-10;
		b=i-9;
		c=i-8;
		d=i-1;
		e=i;
		f=i+1;
		g=i+8;
		h=i+9;
		i=i+10;
	}

/*	
		[a, b, c],
		[d, e, f],
		[g,h, i],
	  */
	console.log(e);
	for(k=0;k<10;k++){
		if(e==bombas[k]){
			band=1;
		}
	}
	if(band==1){
		return -1;
	}else{
		
		
		
		for(k=0;k<10;k++){
		  
			if(a==bombas[k] || b==bombas[k] || c==bombas[k] || d==bombas[k] || e==bombas[k] || f==bombas[k] || g==bombas[k] || h==bombas[k] || i==bombas[k]){
				conta+=1;}
		}
		
			return conta;
		}
}

</script>

</body>
</html>
